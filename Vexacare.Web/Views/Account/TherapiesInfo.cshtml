@using Vexacare.Domain.Entities.Extension
@model TherapiesInfoVM
<!-- Medical Profile Breadcrumb Start -->
<section class="medical-profile-breadcrumb">
    <div class="container">
        <div class="medical-profile-breadcrumb-wrapper">
            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">1</div>
                <p class="medical-profile-breadcrumb-title">Basic Info</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">2</div>
                <p class="medical-profile-breadcrumb-title">Health Info</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">3</div>
                <p class="medical-profile-breadcrumb-title">
                    Gastrointestinal History
                </p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">4</div>
                <p class="medical-profile-breadcrumb-title">
                    Function & Symptoms
                </p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">5</div>
                <p class="medical-profile-breadcrumb-title">Diet Profile</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">6</div>
                <p class="medical-profile-breadcrumb-title">Lifestyle</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number active">7</div>
                <p class="medical-profile-breadcrumb-title">Therapies & Goals</p>
            </div>
        </div>
    </div>
</section>
<!-- Medical Profile Breadcrumb End -->
<!-- Medical Profile Form Start -->
<!-- Medical Profile Form Start -->
<section class="medical-profile-form medical-profile-form-7">
    <div class="container">
        <div class="medical-profile-form-wrapper">
            <div class="form-step">
                <h2 class="form-title">Step 7: Therapies & Goals</h2>

                <form asp-action="TherapiesInfo" method="post">
                    <!-- Recent Antibiotic Use Section -->
                    <div class="form-section">
                        <h3 class="section-title">Recent Antibiotic Use</h3>

                        <div class="yes-no-radio-group">
                            <label class="form-label">Breakfast</label>

                            <div class="radio-options">
                                <label class="radio-option-pill">
                                    <input asp-for="UsedAntibioticsRecently"
                                           type="radio"
                                           value="true"
                                           id="antibiotic-yes" />
                                    <span class="radio-pill-label">Yes</span>
                                </label>
                                <label class="radio-option-pill">
                                    <input asp-for="UsedAntibioticsRecently"
                                           type="radio"
                                           value="false"
                                           id="antibiotic-no"
                                           checked />
                                    <span class="radio-pill-label">No</span>
                                </label>
                            </div>
                            <span asp-validation-for="UsedAntibioticsRecently" class="text-danger"></span>
                        </div>

                        <div class="conditional-field antibiotic-conditional-field @(Model.UsedAntibioticsRecently == true ? "visible" : "")"
                             id="antibiotic-details">
                            <div class="antibiotic-info-input">
                                <label class="form-label" asp-for="AntibioticName"></label>
                                <input type="text"
                                       asp-for="AntibioticName"
                                       class="form-input"
                                       placeholder="Enter antibiotic name" />
                                <span asp-validation-for="AntibioticName" class="text-danger"></span>
                            </div>

                            <div class="antibiotic-info-input">
                                <label class="form-label" asp-for="EndOfTherapyDate"></label>
                                <div class="input-with-icon">
                                    <input type="date"
                                           asp-for="EndOfTherapyDate"
                                           class="form-input"
                                           placeholder="DD/MM/YYYY" />
                                    <span asp-validation-for="EndOfTherapyDate" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Supplementation Section -->
                    <div class="form-section">
                        <h3 class="section-title">Supplementation</h3>

                        <div class="checkbox-grid">
                            <label class="checkbox-option">
                                <input type="checkbox"
                                       asp-for="UsesProbiotics" />
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Probiotics</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox"
                                       asp-for="UsesPrebiotics" />
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Prebiotics</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox"
                                       asp-for="UsesMinerals" />
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Minerals</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox"
                                       asp-for="UsesVitamins" />
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Vitamins</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox"
                                       asp-for="UsesOtherSupplements" />
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">Other</span>
                            </label>
                        </div>

                        <div class="conditional-field @(Model.UsesOtherSupplements ? "visible" : "")"
                             id="other-supplements">
                            <label class="form-label" asp-for="OtherSupplementsDescription"></label>
                            <input type="text"
                                   asp-for="OtherSupplementsDescription"
                                   class="form-input"
                                   placeholder="Enter other supplements" />
                            <span asp-validation-for="OtherSupplementsDescription" class="text-danger"></span>
                        </div>
                    </div>

                    <!-- Primary Health Objective Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            Select Your Primary Health Objective
                        </h3>
                        <span asp-validation-for="PrimaryObjective" class="text-danger"></span>

                        <div class="objective-cards">
                            @foreach (var objective in Enum.GetValues(typeof(PrimaryHealthObjective)).Cast<PrimaryHealthObjective>())
                            {
                                <label class="objective-card">
                                    <input type="radio"
                                           asp-for="PrimaryObjective"
                                           value="@objective" />
                                    <div class="card-content">
                                        <h4>@objective.GetDisplayName()</h4>
                                        @switch (objective)
                                        {
                                            case PrimaryHealthObjective.PreventiveWellbeing:
                                                <p>Measuring optimal health</p>
                                                <ul>
                                                    <li>Active processes</li>
                                                    <li>Healthy, friendly</li>
                                                    <li>General microbiota check</li>
                                                </ul>
                                                break;
                                            case PrimaryHealthObjective.DigestiveOptimization:
                                                <p>Improving digestive function</p>
                                                <ul>
                                                    <li>GI disorders</li>
                                                    <li>Dieting</li>
                                                    <li>IBS</li>
                                                </ul>
                                                break;
                                            case PrimaryHealthObjective.WeightManagement:
                                                <p>Measured optimization</p>
                                                <ul>
                                                    <li>Weight loss</li>
                                                    <li>Insulin resistance</li>
                                                    <li>Dysmetabolism</li>
                                                </ul>
                                                break;
                                            case PrimaryHealthObjective.SportsPerformance:
                                                <p>Performance improvement</p>
                                                <ul>
                                                    <li>Athletes</li>
                                                    <li>Recovery</li>
                                                    <li>Energy support</li>
                                                </ul>
                                                break;
                                        }
                                    </div>
                                </label>
                            }
                        </div>
                    </div>

                    <!-- Secondary Objectives Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            Select Secondary Objectives (You can choose multiple)
                        </h3>

                        <div class="secondary-objectives-grid">
                            @foreach (var objective in Enum.GetValues(typeof(SecondaryObjective)).Cast<SecondaryObjective>())
                            {
                                <label class="secondary-objective">
                                    <input type="checkbox"
                                           name="SecondaryObjectives"
                                           value="@objective"
                                           @(Model.SecondaryObjectives.Contains(objective) ? "checked" : "") />
                                    <span class="objective-label">@objective.GetDisplayName()</span>
                                </label>
                            }
                        </div>
                    </div>

                    <!-- Buttons -->
                    <div class="form-buttons">
                        <a asp-action="LifestyleInfo" class="btn btn-prev">
                            Previous
                        </a>
                        <button type="submit" class="btn btn-submit">
                            Submit & Finish
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Antibiotic use toggle
            const antibioticRadios = document.querySelectorAll(
                'input[name="@Html.NameFor(m => m.UsedAntibioticsRecently)"]'
            );
            const antibioticDetails = document.querySelector("#antibiotic-details");

            antibioticRadios.forEach((radio) => {
                radio.addEventListener("change", function () {
                    antibioticDetails.classList.toggle("visible", this.value === "true");
                });
            });

            // Other supplements toggle
            const otherSupplements = document.querySelector(
                'input[name="@Html.NameFor(m => m.UsesOtherSupplements)"]'
            );
            const otherSupplementsField = document.querySelector("#other-supplements");

            otherSupplements.addEventListener("change", function () {
                otherSupplementsField.classList.toggle("visible", this.checked);
            });
        });
    </script>
}