@model SymptomsInfoVM

<!-- Medical Profile Breadcrumb Start -->
<section class="medical-profile-breadcrumb">
    <div class="container">
        <div class="medical-profile-breadcrumb-wrapper">
            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">1</div>
                <p class="medical-profile-breadcrumb-title">Basic Info</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">2</div>
                <p class="medical-profile-breadcrumb-title">Health Info</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number compleate">3</div>
                <p class="medical-profile-breadcrumb-title">
                    Gastrointestinal History
                </p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number active">4</div>
                <p class="medical-profile-breadcrumb-title">
                    Function & Symptoms
                </p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number">5</div>
                <p class="medical-profile-breadcrumb-title">Diet Profile</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number">6</div>
                <p class="medical-profile-breadcrumb-title">Lifestyle</p>
            </div>

            <div class="medical-profile-breadcrumb-line"></div>

            <div class="medical-profile-breadcrumb-content">
                <div class="medical-profile-breadcrumb-number">7</div>
                <p class="medical-profile-breadcrumb-title">Therapies & Goals</p>
            </div>
        </div>
    </div>
</section>
<!-- Medical Profile Breadcrumb End -->
<!-- Medical Profile Form Start -->
<section class="medical-profile-form medical-profile-form-4">
    <div class="container">
        <div class="medical-profile-form-wrapper">
            <div class="form-step">
                <h2 class="form-title">Step 4: Function & Symptoms</h2>

                <form asp-action="SymptomsInfo" method="post">
                    <!-- Intestinal Function Section -->
                    <div class="form-section">
                        <h3 class="section-title">Intestinal Function</h3>

                        <div class="symptom-scale-custom">
                            <div class="symptom-scale-custom-item">
                                <label class="form-label">Frequency of evacuations</label>
                                <div class="range-input-container">
                                    <input asp-for = "FrequencyOfEvaluations" type="text"
                                           class="form-input"
                                           min="0"
                                           max="10"
                                           />
                                    <span asp-validation-for="FrequencyOfEvaluations" class="text-danger"></span>
                                    <div class="range-value evacuation-range-value">
                                        /day
                                    </div>
                                    
                                </div>
                            </div>

                            <div class="symptom-scale-custom-item">
                                <label class="form-label">Bristol Scale</label>
                                <div class="custom-select-wrapper">
                                    <select asp-for="BristolScale" class="form-input custom-select">
                                        <option value="1">Separate hard lumps</option>
                                        <option value="2">Lumpy and sausage-like</option>
                                        <option value="3">Sausage-shaped with cracks</option>
                                        <option value="4">Smooth, soft sausage</option>
                                        <option value="5"> Soft blobs with clear edges</option>
                                        <option value="6"> Fluffy pieces with ragged edges</option>
                                        <option value="7">Watery, no solid pieces</option>
                                    </select>
                                    <span asp-validation-for="BristolScale" class="text-danger"></span>
                                    <div class="custom-select-arrow">▼</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Current Symptoms Section -->
                    <div class="form-section">
                        <h3 class="section-title">Current Symptoms</h3>

                        <div class="symptom-scale">
                            <label class="form-label">Bloating Severity</label>
                            <div class="range-input-container">
                                <input asp-for="BloatingSeverity" type="range"
                                       class="form-range-input"
                                       min="0"
                                       max="10"
                                       />
                                <span asp-validation-for="BloatingSeverity" class="text-danger"></span>
                                <div class="range-value">6</div>
                            </div>
                            <div class="scale-labels">
                                <span>0 = None</span>
                                <span>10 = Severe</span>
                            </div>
                        </div>

                        <div class="symptom-scale">
                            <label class="form-label">Intestinal Gas</label>
                            <div class="range-input-container">
                                <input asp-for="IntestinalGas" type="range"
                                       class="form-range-input"
                                       min="0"
                                       max="10"
                                       />
                                <span asp-validation-for="IntestinalGas" class="text-danger"></span>
                                <div class="range-value">4</div>
                            </div>
                            <div class="scale-labels">
                                <span>0 = None</span>
                                <span>10 = Severe</span>
                            </div>
                        </div>

                        <div class="symptom-scale">
                            <label class="form-label">Abdominal Pain</label>
                            <div class="range-input-container">
                                <input asp-for="AbdominalPain" type="range"
                                       class="form-range-input"
                                       min="0"
                                       max="10"
                                       />
                                <span asp-validation-for="AbdominalPain" class="text-danger"></span>
                                <div class="range-value">7</div>
                            </div>
                            <div class="scale-labels">
                                <span>0 = None</span>
                                <span>10 = Severe</span>
                            </div>
                        </div>

                        <div class="symptom-scale">
                            <label class="form-label">Digestive Difficulties</label>
                            <div class="range-input-container">
                                <input asp-for="DigestiveDifficulties" type="range"
                                       class="form-range-input"
                                       min="0"
                                       max="10"
                                       />
                                <span asp-validation-for="DigestiveDifficulties" class="text-danger"></span>
                                <div class="range-value">5</div>
                            </div>
                            <div class="scale-labels">
                                <span>0 = None</span>
                                <span>10 = Severe</span>
                            </div>
                        </div>
                    </div>

                    <!-- Food Sensitivities Section -->
                    <div class="form-section">
                        <h3 class="section-title">Food Sensitivities</h3>

                        <label class="form-label">Diagnosed intolerances</label>
                        <input asp-for="DiagnosedIntolerances" type="text"
                               class="form-input"
                               placeholder="e.g., Lactose, Gluten" />
                        <span asp-validation-for="DiagnosedIntolerances" class="text-danger"></span>

                        <label class="form-label">Certified allergies</label>
                        <input asp-for="CertifiedAllergies" type="text"
                               class="form-input"
                               placeholder="e.g., Peanuts, Shellfish" />
                        <span asp-validation-for="CertifiedAllergies" class="text-danger"></span>

                        <label class="form-label">Tests performed</label>
                        <input asp-for="TestsPerformed" type="text"
                               class="form-input"
                               placeholder="e.g., IgG test, Skin prick test" />
                        <span asp-validation-for="TestsPerformed" class="text-danger"></span>
                    </div>

                    <!-- Buttons -->
                    <div class="form-buttons">
                        @* <button type="button"
                                class="btn btn-prev"
                                onclick="prevStep()">
                            Previous
                        </button>
                        <button type="submit" class="btn btn-next">Next</button> *@
                        <a asp-controller="Account" asp-action="GastrointestinalInfo" type="button" class="btn btn-prev">Previous</a>
                        <button asp-controller="Account" asp-action="SymptomsInfo" type="submit" class="btn btn-next">Next</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>
<!-- Medical Profile Form End -->

@* <script>
    // Range slider
    document.querySelectorAll(".form-range-input").forEach((slider) => {
      const valueDisplay = slider.nextElementSibling;

      function updateSlider() {
        const val = slider.value;
        const min = slider.min || 0;
        const max = slider.max || 10;
        const percent = ((val - min) * 100) / (max - min);
        slider.style.setProperty("--value", `${percent}%`);
        valueDisplay.textContent = val;
      }

      slider.addEventListener("input", updateSlider);
      updateSlider();
    });
</script> *@

<script>
    document.querySelectorAll(".range-input-container").forEach((container) => {
        const slider = container.querySelector(".form-range-input");
        const valueDisplay = container.querySelector(".range-value");

        if (!slider || !valueDisplay) return; // Skip if any element is missing

        function updateSlider() {
            const val = slider.value;
            const min = slider.min || 0;
            const max = slider.max || 10;
            const percent = ((val - min) * 100) / (max - min);
            slider.style.setProperty("--value", `${percent}%`);
            valueDisplay.textContent = val;
        }

        slider.addEventListener("input", updateSlider);
        updateSlider(); // Initialize on page load
    });
</script>
